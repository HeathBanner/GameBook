{"ast":null,"code":"import _defineProperty from \"/Users/God/Desktop/github/SocialMedia/gamebook/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/God/Desktop/github/SocialMedia/gamebook/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/God/Desktop/github/SocialMedia/gamebook/client/src/contexts/AuthContext.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { createContext, useState, useEffect } from 'react';\nimport { useTheme } from '@material-ui/core/styles';\nimport { useMediaQuery } from '@material-ui/core';\nimport TokenStore from '../library/TokenStore';\nexport const AuthContext = createContext();\nconst initUser = {\n  info: '',\n  token: TokenStore.getToken()\n};\nexport const AuthProvider = props => {\n  const _useState = useState(_objectSpread({}, initUser)),\n        _useState2 = _slicedToArray(_useState, 2),\n        user = _useState2[0],\n        setUser = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        loggedIn = _useState4[0],\n        setLoggedIn = _useState4[1];\n\n  useEffect(() => {\n    if (!user.token) {\n      return;\n    }\n\n    fetch('/api/users/verify').then(res => res.json()).then(user => {\n      console.log(user);\n      return setUser(_objectSpread({}, user));\n    }).catch(() => {\n      console.log('Oops...');\n    });\n  }, [user]);\n\n  const handleLogin = (user, authToken) => {\n    TokenStore.setToken(authToken);\n    setUser({\n      info: _objectSpread({}, user),\n      token: authToken\n    });\n  };\n\n  const handleLogout = () => {\n    TokenStore.clearToken();\n    setUser(_objectSpread({}, initUser));\n    return setLoggedIn(false);\n  };\n\n  const getNewStory = () => {\n    fetch('/api/users/portfolio').then(res => res.json()).then(user => {\n      return setUser(_objectSpread({}, user));\n    }).catch(() => {\n      console.log('Ooops...');\n    });\n  };\n\n  return React.createElement(AuthContext.Provider, {\n    value: {\n      user,\n      handleLogin,\n      handleLogout,\n      loggedIn,\n      getNewStory\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, props.children);\n};","map":{"version":3,"sources":["/Users/God/Desktop/github/SocialMedia/gamebook/client/src/contexts/AuthContext.js"],"names":["React","createContext","useState","useEffect","useTheme","useMediaQuery","TokenStore","AuthContext","initUser","info","token","getToken","AuthProvider","props","user","setUser","loggedIn","setLoggedIn","fetch","then","res","json","console","log","catch","handleLogin","authToken","setToken","handleLogout","clearToken","getNewStory","children"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,aAAhB,EAA+BC,QAA/B,EAAyCC,SAAzC,QAA0D,OAA1D;AAEA,SAASC,QAAT,QAAyB,0BAAzB;AACA,SAASC,aAAT,QAA8B,mBAA9B;AAEA,OAAOC,UAAP,MAAuB,uBAAvB;AAEA,OAAO,MAAMC,WAAW,GAAGN,aAAa,EAAjC;AAEP,MAAMO,QAAQ,GAAG;AACfC,EAAAA,IAAI,EAAE,EADS;AAEfC,EAAAA,KAAK,EAAEJ,UAAU,CAACK,QAAX;AAFQ,CAAjB;AAKA,OAAO,MAAMC,YAAY,GAAIC,KAAD,IAAW;AAAA,oBAEbX,QAAQ,mBAAMM,QAAN,EAFK;AAAA;AAAA,QAE9BM,IAF8B;AAAA,QAExBC,OAFwB;;AAAA,qBAGLb,QAAQ,CAAC,KAAD,CAHH;AAAA;AAAA,QAG9Bc,QAH8B;AAAA,QAGpBC,WAHoB;;AAKrCd,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACW,IAAI,CAACJ,KAAV,EAAiB;AAAE;AAAS;;AAC5BQ,IAAAA,KAAK,CAAC,mBAAD,CAAL,CACGC,IADH,CACQC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADf,EAEGF,IAFH,CAESL,IAAD,IAAU;AACdQ,MAAAA,OAAO,CAACC,GAAR,CAAYT,IAAZ;AACA,aAAOC,OAAO,mBAAMD,IAAN,EAAd;AACD,KALH,EAMGU,KANH,CAMS,MAAM;AAAEF,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AAAyB,KAN1C;AAOD,GATQ,EASN,CAACT,IAAD,CATM,CAAT;;AAWA,QAAMW,WAAW,GAAG,CAACX,IAAD,EAAOY,SAAP,KAAqB;AACvCpB,IAAAA,UAAU,CAACqB,QAAX,CAAoBD,SAApB;AACAX,IAAAA,OAAO,CAAC;AACNN,MAAAA,IAAI,oBAAOK,IAAP,CADE;AAENJ,MAAAA,KAAK,EAAEgB;AAFD,KAAD,CAAP;AAID,GAND;;AAQA,QAAME,YAAY,GAAG,MAAM;AACzBtB,IAAAA,UAAU,CAACuB,UAAX;AACAd,IAAAA,OAAO,mBAAMP,QAAN,EAAP;AACA,WAAOS,WAAW,CAAC,KAAD,CAAlB;AACD,GAJD;;AAMA,QAAMa,WAAW,GAAG,MAAM;AACxBZ,IAAAA,KAAK,CAAC,sBAAD,CAAL,CACGC,IADH,CACQC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADf,EAEGF,IAFH,CAESL,IAAD,IAAU;AAAE,aAAOC,OAAO,mBAAMD,IAAN,EAAd;AAA8B,KAFlD,EAGGU,KAHH,CAGS,MAAM;AAAEF,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AAA0B,KAH3C;AAID,GALD;;AAOA,SACE,oBAAC,WAAD,CAAa,QAAb;AACE,IAAA,KAAK,EAAE;AACLT,MAAAA,IADK;AAELW,MAAAA,WAFK;AAGLG,MAAAA,YAHK;AAILZ,MAAAA,QAJK;AAKLc,MAAAA;AALK,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KASGjB,KAAK,CAACkB,QATT,CADF;AAaD,CAlDM","sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\n\nimport { useTheme } from '@material-ui/core/styles';\nimport { useMediaQuery } from '@material-ui/core';\n\nimport TokenStore from '../library/TokenStore';\n\nexport const AuthContext = createContext();\n\nconst initUser = {\n  info: '',\n  token: TokenStore.getToken(),\n};\n\nexport const AuthProvider = (props) => {\n\n  const [user, setUser] = useState({ ...initUser });\n  const [loggedIn, setLoggedIn] = useState(false);\n\n  useEffect(() => {\n    if (!user.token) { return; }\n    fetch('/api/users/verify')\n      .then(res => res.json())\n      .then((user) => {\n        console.log(user);\n        return setUser({ ...user });\n      })\n      .catch(() => { console.log('Oops...'); });\n  }, [user]);\n\n  const handleLogin = (user, authToken) => {\n    TokenStore.setToken(authToken);\n    setUser({\n      info: { ...user },\n      token: authToken,\n    });\n  };\n\n  const handleLogout = () => {\n    TokenStore.clearToken();\n    setUser({ ...initUser });\n    return setLoggedIn(false);\n  };\n\n  const getNewStory = () => {\n    fetch('/api/users/portfolio')\n      .then(res => res.json())\n      .then((user) => { return setUser({ ...user }); })\n      .catch(() => { console.log('Ooops...'); });\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        handleLogin,\n        handleLogout,\n        loggedIn,\n        getNewStory,\n      }}\n    >\n      {props.children}\n    </AuthContext.Provider>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}